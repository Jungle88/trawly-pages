<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trawly â€” Production Architecture</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;background:#0d1117;color:#e6edf3;line-height:1.7;padding:32px 24px;max-width:780px;margin:0 auto}
a{color:#58a6ff;text-decoration:none}a:hover{text-decoration:underline}
h1{font-size:2em;color:#fff;margin-bottom:4px}
h2{font-size:1.5em;color:#e6edf3;margin:40px 0 16px;padding-bottom:8px;border-bottom:2px solid #58a6ff}
h3{font-size:1.15em;color:#c9d1d9;margin:24px 0 10px}
h4{font-size:1em;color:#8b949e;margin:16px 0 8px}
p,.subtitle{color:#c9d1d9;margin-bottom:14px}
.subtitle{color:#8b949e;font-size:0.95em;margin-bottom:28px}
strong{color:#e6edf3}
em{color:#8b949e}
hr{border:none;border-top:1px solid #21262d;margin:32px 0}
ul,ol{padding-left:24px;margin-bottom:14px}
li{margin-bottom:6px;color:#c9d1d9}
table{width:100%;border-collapse:collapse;margin:16px 0 24px;font-size:0.9em}
th{background:#161b22;color:#58a6ff;text-align:left;padding:10px 12px;border:1px solid #21262d;font-weight:600}
td{padding:10px 12px;border:1px solid #21262d;color:#c9d1d9}
tr:nth-child(even) td{background:#161b22}
tr:nth-child(odd) td{background:#0d1117}
code{background:#161b22;color:#e6edf3;padding:2px 6px;border-radius:4px;font-size:0.9em;font-family:'SF Mono',SFMono-Regular,Consolas,monospace}
pre{background:#161b22;border:1px solid #21262d;border-radius:8px;padding:16px 20px;overflow-x:auto;margin:16px 0 24px;font-size:0.85em;line-height:1.5}
pre code{background:none;padding:0}
blockquote{border-left:3px solid #58a6ff;padding:8px 16px;margin:16px 0;color:#8b949e;background:#161b2280}
.back{display:inline-block;margin-bottom:20px;color:#58a6ff;font-size:0.9em}
.footer{color:#484f58;font-size:0.8em;text-align:center;margin-top:48px;padding-top:24px;border-top:1px solid #21262d}
</style>
</head>
<body>
<a href="sunday-todo.html" class="back">â† Back to Sunday Plan</a>
<h1>ğŸ—ï¸ Trawly â€” Production Architecture</h1>
<p class="subtitle">Ship Date: Sunday, March 1, 2026 Â· Phase 1 Target: 20 friends beta â†’ feedback Â· Scale Target: 10,000+ subscribers</p>

<h2>1. What We're Building Sunday</h2>
<p>A daily AI-curated email digest that trawls the ENTIRE internet â€” X, Reddit, Hacker News, blogs, YouTube, news sites â€” for the best content, packages it beautifully, and delivers it to subscribers. Full self-serve: signup â†’ configure topics â†’ receive daily digest. Plus X integration (@heytrawly tagging to save content).</p>

<h3>Sunday Deliverables</h3>
<ol>
<li><strong>Landing page</strong> (heytrawly.com) â€” value prop + email signup</li>
<li><strong>Content pipeline</strong> â€” automated X research â†’ AI curation â†’ HTML email</li>
<li><strong>Email delivery</strong> â€” proper transactional email service (not Gmail)</li>
<li><strong>20 beta invites</strong> â€” David's friends get Day 1 access</li>
</ol>

<h2>2. Tech Stack</h2>

<h3>Frontend / Landing Page</h3>
<table>
<tr><th>Component</th><th>Choice</th><th>Why</th></tr>
<tr><td>Framework</td><td>Next.js 14 (App Router)</td><td>David's comfort zone, Vercel deploy, React ecosystem</td></tr>
<tr><td>Styling</td><td>Tailwind CSS</td><td>Fast iteration, responsive by default</td></tr>
<tr><td>Hosting</td><td>Vercel</td><td>Zero-config, free tier covers us, edge functions</td></tr>
<tr><td>Domain</td><td>heytrawly.com</td><td>TBC â€” David to confirm</td></tr>
</table>

<h3>Backend / API</h3>
<table>
<tr><th>Component</th><th>Choice</th><th>Why</th></tr>
<tr><td>Runtime</td><td>Node.js (Vercel serverless)</td><td>No server to manage, scales automatically</td></tr>
<tr><td>Database</td><td>Supabase (PostgreSQL)</td><td>Auth + DB + real-time, generous free tier, pgvector for future embeddings</td></tr>
<tr><td>Cache</td><td>Upstash Redis (serverless)</td><td>Rate limiting, content cache, session data. Free tier: 10K commands/day</td></tr>
<tr><td>Queue</td><td>Vercel Cron + Inngest</td><td>Scheduled jobs, event-driven workflows</td></tr>
</table>

<h3>Content Pipeline (Multi-Source)</h3>
<table>
<tr><th>Source</th><th>Method</th><th>Cost</th><th>Rate Limits</th></tr>
<tr><td>X/Twitter</td><td>Official X API (pay-as-you-go)</td><td>~$50-100/mo</td><td>Credit-based, spending caps</td></tr>
<tr><td>Reddit</td><td>Official API (free)</td><td>$0</td><td>100 req/min</td></tr>
<tr><td>Hacker News</td><td>Firebase API</td><td>$0</td><td>Unlimited, real-time</td></tr>
<tr><td>RSS/Blogs</td><td>Direct fetch</td><td>$0</td><td>Self-throttled</td></tr>
<tr><td>YouTube</td><td>Transcript extraction</td><td>~$0</td><td>10K units/day free</td></tr>
<tr><td>News sites</td><td>Jina Reader API</td><td>Free tier</td><td>20 req/min</td></tr>
<tr><td>X tagging</td><td>Webhook listener</td><td>Included in X API</td><td>â€”</td></tr>
</table>

<h3>AI Models (Simplified Single-Pass)</h3>
<table>
<tr><th>Component</th><th>Choice</th><th>Why</th></tr>
<tr><td>Single-pass digest</td><td>Claude Opus 4</td><td>One call does scoring + curation + composition + personalisation. ~$0.30-0.40/digest</td></tr>
<tr><td>Taste profile update</td><td>Claude Sonnet 4</td><td>Post-engagement profile recalculation. ~$0.05/digest</td></tr>
<tr><td>Fallback</td><td>Queue and retry</td><td>If Anthropic is down, queue and retry. No multi-model fallback for MVP</td></tr>
</table>
<p>Routed through <strong>OpenRouter</strong> for access to all models if we need to optimise at scale.</p>

<h3>Email Delivery</h3>
<table>
<tr><th>Component</th><th>Choice</th><th>Why</th></tr>
<tr><td>Service</td><td>Resend</td><td>Built for devs, React Email integration, $20/mo for 50K emails</td></tr>
<tr><td>Template</td><td>React Email</td><td>JSX-based email templates, renders to cross-client HTML</td></tr>
<tr><td>Alternative</td><td>Loops.so</td><td>Built-in subscriber management + analytics. $49/mo for 5K contacts</td></tr>
</table>

<h2>3. Architecture Diagram</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VERCEL (Frontend)                   â”‚
â”‚  Landing Page â”€â”€ Signup â”€â”€ Topic Config â”€â”€ Dashboard  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â–¼
        â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     â”‚   SUPABASE         â”‚
        â”‚     â”‚  subscribers       â”‚
        â”‚     â”‚  digests           â”‚
        â”‚     â”‚  content_items     â”‚
        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚
        â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SIMPLIFIED PIPELINE                       â”‚
â”‚                                                        â”‚
â”‚  FETCH (code, parallel)                                â”‚
â”‚    X API Â· Reddit API Â· HN Firebase Â· RSS Â· News      â”‚
â”‚           â–¼                                            â”‚
â”‚  OPUS SINGLE PASS â”€â”€â”€ Claude Opus 4                    â”‚
â”‚    Scores + curates + composes + personalises          â”‚
â”‚    "Why this matters to you" boxes Â· ~$0.30-0.40      â”‚
â”‚           â–¼                                            â”‚
â”‚  RENDER â”€â”€â”€â”€ React Email â”€â”€â”€â”€ HTML email               â”‚
â”‚           â–¼                                            â”‚
â”‚  DELIVER â”€â”€â”€ Resend â”€â”€â”€â”€â”€â”€â”€â”€â”€ Inbox                    â”‚
â”‚                                                        â”‚
â”‚  POST-SEND: Engagement â†’ Sonnet taste profile update   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>

<h3>Pipeline Schedule</h3>
<ul>
<li><strong>Research window:</strong> 6am-7am AEDT (previous 24h content)</li>
<li><strong>Delivery:</strong> 7:30am AEDT (or subscriber-local time in v2)</li>
</ul>

<h2>4. AI Model Strategy â€” Single-Pass Pipeline</h2>
<p>After 3 weeks of production data, we learned that splitting into separate scoring â†’ dedup â†’ summarisation â†’ curation â†’ composition steps was over-engineering. <strong>One Opus call does it all.</strong></p>
<p><strong>Why single-pass works:</strong> Opus is smart enough to hold ~80 posts + the user's taste profile in context and do scoring, curation, composition, and personalisation in a single pass. Splitting into steps adds cost and latency without improving quality.</p>

<table>
<tr><th>Step</th><th>Method</th><th>Cost/Digest</th></tr>
<tr><td>Fetch content</td><td>Code (no AI)</td><td>$0 (API costs separate)</td></tr>
<tr><td>Score + curate + compose + personalise</td><td>Claude Opus 4 â€” single pass</td><td>~$0.30-0.40</td></tr>
<tr><td>Taste profile update</td><td>Claude Sonnet 4 â€” post-engagement</td><td>~$0.05</td></tr>
</table>

<h3>Real Production COGS (3 weeks of data)</h3>
<table>
<tr><th>Component</th><th>Cost/Digest</th></tr>
<tr><td>Opus single pass</td><td>$0.30-0.40</td></tr>
<tr><td>X API</td><td>$0.05-0.08</td></tr>
<tr><td>Web searches</td><td>~$0.02</td></tr>
<tr><td>Email delivery</td><td>~$0.004</td></tr>
<tr><td><strong>Total per digest</strong></td><td><strong>~$0.40</strong></td></tr>
<tr><td><strong>Monthly per user</strong></td><td><strong>~$12</strong></td></tr>
</table>

<h3>Fixed Infrastructure (~$140/mo)</h3>
<p>Vercel $20 + Supabase $25 + Resend $20 + X API ~$75 + misc ~$5</p>
<p><strong>Total LLM cost per digest: ~$0.35-0.45</strong></p>

<h2 id="x-data-strategy">5. X Data Strategy</h2>

<h3>Approach: Official X API (Pay-As-You-Go)</h3>
<p>We use X's official API with their pay-as-you-go pricing model (launched Feb 2026). Credit-based â€” buy credits, deducted per API request, with spending caps and auto-recharge. No fixed monthly subscription needed. Full commercial use rights through the official developer agreement.</p>
<p><strong>Cost estimate:</strong> ~$50-100/mo for our daily research volume (~2,000-3,000 tweets scanned/day).</p>
<p>We considered third-party providers (SocialData, Apify, RapidAPI proxies) but chose the official API for TOS compliance. Third-party providers operate in a grey area and could be shut down at any time.</p>

<h3>Content Approach: Original Editorial</h3>
<p>We do NOT reproduce full tweet text in emails. Instead, we write <strong>original AI summaries and editorial commentary</strong> about trending content, and always <strong>link back to the original post on X</strong> ("Read on X â†’"). On the web app, we use X's official embed widgets. Our value is curation + voice, not raw content redistribution â€” editorially identical to TLDR, Morning Brew, etc.</p>

<h2>6. Email Delivery & Deliverability</h2>
<h3>Why Not Gmail</h3>
<ul>
<li>No DKIM/SPF control â†’ lands in spam</li>
<li>No open/click tracking</li>
<li>No unsubscribe management (CAN-SPAM)</li>
<li>Doesn't scale past ~50 emails/day</li>
</ul>
<h3>Resend Setup</h3>
<ol>
<li>Custom domain: send@heytrawly.com</li>
<li>DNS records: DKIM + SPF + DMARC auto-configured</li>
<li>Warm-up plan: Start with 20 friends â†’ ramp 10%/day</li>
<li>Tracking: Opens, clicks, bounces via Resend dashboard</li>
<li>Unsubscribe: One-click header (Gmail requirement)</li>
</ol>
<p><strong>Cost: $20/mo for 50K emails</strong></p>

<h2>7. Data Model</h2>
<pre><code>-- Core tables
CREATE TABLE subscribers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email TEXT UNIQUE NOT NULL,
  name TEXT,
  status TEXT DEFAULT 'active',
  topics JSONB DEFAULT '[]',
  preferences JSONB DEFAULT '{}',
  timezone TEXT DEFAULT 'America/New_York',
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE digests (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  date DATE NOT NULL,
  subject TEXT NOT NULL,
  html_content TEXT NOT NULL,
  total_cost DECIMAL(10,4),
  sent_count INT DEFAULT 0,
  open_count INT DEFAULT 0,
  click_count INT DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE content_items (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  digest_id UUID REFERENCES digests(id),
  source_type TEXT NOT NULL,
  source_url TEXT NOT NULL,
  content_text TEXT NOT NULL,
  summary TEXT,
  quality_score DECIMAL(3,2),
  embedding VECTOR(1536),
  created_at TIMESTAMPTZ DEFAULT NOW()
);</code></pre>

<h2>8. Phase Roadmap</h2>
<h3>Phase 1: Ship Sunday â€” "20 Friends"</h3>
<ul>
<li>Landing page live on heytrawly.com</li>
<li>Supabase schema deployed</li>
<li>Content pipeline running</li>
<li>20 beta invites sent</li>
<li>First digest delivered Monday morning</li>
</ul>
<h3>Phase 2: Week 2-3 â€” "Polish & Learn"</h3>
<ul>
<li>Reply-to-email feedback processing</li>
<li>Engagement tracking</li>
<li>Add more sources (HN, Reddit, RSS)</li>
<li>Referral system</li>
</ul>
<h3>Phase 3: Month 2 â€” "Open Up"</h3>
<ul>
<li>Public waitlist â†’ launch</li>
<li>Stripe payments (free + $12/mo Pro)</li>
<li>Topic customization per subscriber</li>
<li>Dashboard</li>
</ul>
<h3>Phase 4: Month 3+ â€” "Scale"</h3>
<ul>
<li>Team digests</li>
<li>Interactive podcast format</li>
<li>Mobile app / PWA</li>
<li>Content intelligence API</li>
</ul>

<h2>9. Risk Register</h2>
<table>
<tr><th>Risk</th><th>Severity</th><th>Mitigation</th></tr>
<tr><td>Email lands in spam</td><td>Medium</td><td>Proper DKIM/SPF/DMARC + warm-up.</td></tr>
<tr><td>AI curation quality inconsistent</td><td>Medium</td><td>Human review loop for first 2 weeks.</td></tr>
<tr><td>Costs spiral at scale</td><td>Low</td><td>Unit economics validated: ~$0.40/digest vs $19/mo revenue = 63% margin.</td></tr>
<tr><td>X API pricing changes</td><td>Low</td><td>Pay-as-you-go means we only pay for what we use. Easy to adjust volume.</td></tr>
<tr><td>Content approach challenged by X</td><td>Low</td><td>Editorial summaries with links is standard newsletter practice (TLDR, Morning Brew).</td></tr>
</table>

<div class="footer">âš¡ Trawly Architecture V2 â€” March 2026</div>
</body>
</html>
